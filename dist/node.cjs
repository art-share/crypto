"use strict";var e=require("@noble/hashes/scrypt"),t=require("@noble/hashes/utils");const r={development:{N:16384,r:8,p:1,dkLen:32},standard:{N:65536,r:8,p:1,dkLen:32},high:{N:2**18,r:8,p:1,dkLen:32},paranoid:{N:2**20,r:8,p:1,dkLen:32}},n="standard",o=r[n],s={MIN_N:1024,MAX_N:2**24,MIN_R:1,MAX_R:64,MIN_P:1,MAX_P:64,MIN_DKLEN:16,MAX_DKLEN:128};function a(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function i(e){if(e.length%2!=0)throw new Error("Invalid hex string: odd length");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return t}function p(){return a(t.randomBytes(32))}function c(){return a(t.randomBytes(16))}function d(e){const{N:t,r:r,p:n,dkLen:o}=e;if(t<=0||t&t-1)throw new Error("N must be a power of 2");if(t<s.MIN_N||t>s.MAX_N)throw new Error(`N must be between ${s.MIN_N} and ${s.MAX_N}`);if(r<s.MIN_R||r>s.MAX_R)throw new Error(`r must be between ${s.MIN_R} and ${s.MAX_R}`);if(n<s.MIN_P||n>s.MAX_P)throw new Error(`p must be between ${s.MIN_P} and ${s.MAX_P}`);if(o<s.MIN_DKLEN||o>s.MAX_DKLEN)throw new Error(`dkLen must be between ${s.MIN_DKLEN} and ${s.MAX_DKLEN}`);const a=128*t*r,i=1073741824;if(a>i)throw new Error(`Memory requirement (${Math.round(a/1024/1024)}MB) exceeds limit (1024MB)`)}async function u(t,r,n=o){d(n);const s=r||p(),c=i(s);try{const r=await e.scryptAsync(t,c,n);return{hash:a(r),salt:s,params:n,timestamp:Date.now()}}finally{}}function h(e){return{...r[e]}}exports.DEFAULT_SCRYPT_PARAMS=o,exports.DEFAULT_SECURITY_LEVEL=n,exports.SALT_LENGTH=32,exports.SCRYPT_LIMITS=s,exports.SCRYPT_PRESETS=r,exports.SUPPORTED_ALGORITHMS=["scrypt"],exports.VERSION="1.0.0",exports.bytesToHex=a,exports.clientHashPassword=async function(e,t,r){return(await u(e,t,r)).hash},exports.createLoginParams=function(e="standard"){return{algorithm:"scrypt",params:h(e),salt:p(),formToken:c()}},exports.detectCryptoCapabilities=function(){const e="undefined"!=typeof process&&process.versions?.node,t="undefined"!=typeof window;return{webCrypto:"undefined"!=typeof crypto&&void 0!==crypto.subtle,secureContext:"undefined"!=typeof globalThis&&globalThis.isSecureContext||"undefined"!=typeof window&&window.isSecureContext||!0,nodeEnvironment:Boolean(e),browserEnvironment:t}},exports.estimateHashingTime=function(e){const{N:t,r:r,p:n}=e,o=t/65536*200*(r/8)*n;return Math.round(o)},exports.generateFormToken=c,exports.generateSalt=p,exports.getScryptParams=h,exports.hashPassword=u,exports.hashPasswordSync=function(t,r,n=o){d(n);const s=r||p(),c=i(s);try{const r=e.scrypt(t,c,n);return{hash:a(r),salt:s,params:n,timestamp:Date.now()}}finally{}},exports.hexToBytes=i,exports.serverHashPassword=async function(e,t,r=o){return(await u(e,t,r)).hash},exports.timingSafeEqual=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e.charCodeAt(n)^t.charCodeAt(n);return 0===r},exports.validateScryptParams=d,exports.verifyPassword=async function(e,t,r,n){try{return(await u(e,r,n)).hash===t}finally{}};
//# sourceMappingURL=node.cjs.map
