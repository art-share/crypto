"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@noble/hashes/scrypt"),r=require("@noble/hashes/utils");const t={development:{N:16384,r:8,p:1,dkLen:32},standard:{N:65536,r:8,p:1,dkLen:32},high:{N:2**18,r:8,p:1,dkLen:32},paranoid:{N:2**20,r:8,p:1,dkLen:32}},n="standard",o=t[n],s={MIN_N:1024,MAX_N:2**24,MIN_R:1,MAX_R:64,MIN_P:1,MAX_P:64,MIN_DKLEN:16,MAX_DKLEN:128};function a(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function i(e){if(e.length%2!=0)throw new Error("Invalid hex string: odd length");const r=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)r[t/2]=parseInt(e.slice(t,t+2),16);return r}function p(){return a(r.randomBytes(32))}function d(){return a(r.randomBytes(16))}function c(e){const{N:r,r:t,p:n,dkLen:o}=e;if(r<=0||r&r-1)throw new Error("N must be a power of 2");if(r<s.MIN_N||r>s.MAX_N)throw new Error(`N must be between ${s.MIN_N} and ${s.MAX_N}`);if(t<s.MIN_R||t>s.MAX_R)throw new Error(`r must be between ${s.MIN_R} and ${s.MAX_R}`);if(n<s.MIN_P||n>s.MAX_P)throw new Error(`p must be between ${s.MIN_P} and ${s.MAX_P}`);if(o<s.MIN_DKLEN||o>s.MAX_DKLEN)throw new Error(`dkLen must be between ${s.MIN_DKLEN} and ${s.MAX_DKLEN}`);const a=128*r*t,i=1073741824;if(a>i)throw new Error(`Memory requirement (${Math.round(a/1024/1024)}MB) exceeds limit (1024MB)`)}async function u(r,t,n=o){c(n);const s=t||p(),d=i(s);try{const t=await e.scryptAsync(r,d,n);return{hash:a(t),salt:s,params:n,timestamp:Date.now()}}finally{}}async function h(e,r,t,n){try{return(await u(e,t,n)).hash===r}finally{}}function f(e){return{...t[e]}}function w(e="standard"){return{algorithm:"scrypt",params:f(e),salt:p(),formToken:d()}}async function l(e,r,t){return(await u(e,r,t)).hash}async function y(e,r,t=o){return(await u(e,r,t)).hash}var N={hashPassword:u,verifyPassword:h,createLoginParams:w,clientHashPassword:l,serverHashPassword:y};exports.DEFAULT_SCRYPT_PARAMS=o,exports.DEFAULT_SECURITY_LEVEL=n,exports.SALT_LENGTH=32,exports.SCRYPT_LIMITS=s,exports.SCRYPT_PRESETS=t,exports.SUPPORTED_ALGORITHMS=["scrypt"],exports.VERSION="1.0.0",exports.bytesToHex=a,exports.clientHashPassword=l,exports.createLoginParams=w,exports.default=N,exports.detectCryptoCapabilities=function(){const e="undefined"!=typeof process&&process.versions?.node,r="undefined"!=typeof window;return{webCrypto:"undefined"!=typeof crypto&&void 0!==crypto.subtle,secureContext:"undefined"!=typeof globalThis&&globalThis.isSecureContext||"undefined"!=typeof window&&window.isSecureContext||!0,nodeEnvironment:Boolean(e),browserEnvironment:r}},exports.estimateHashingTime=function(e){const{N:r,r:t,p:n}=e,o=r/65536*200*(t/8)*n;return Math.round(o)},exports.generateFormToken=d,exports.generateSalt=p,exports.getScryptParams=f,exports.hashPassword=u,exports.hashPasswordSync=function(r,t,n=o){c(n);const s=t||p(),d=i(s);try{const t=e.scrypt(r,d,n);return{hash:a(t),salt:s,params:n,timestamp:Date.now()}}finally{}},exports.hexToBytes=i,exports.serverHashPassword=y,exports.timingSafeEqual=function(e,r){if(e.length!==r.length)return!1;let t=0;for(let n=0;n<e.length;n++)t|=e.charCodeAt(n)^r.charCodeAt(n);return 0===t},exports.validateScryptParams=c,exports.verifyPassword=h;
//# sourceMappingURL=index.cjs.map
